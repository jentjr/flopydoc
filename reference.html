

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>flopy.utils.reference Module &mdash; flopy 3.2.8 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="flopy 3.2.8 documentation" href="index.html"/>
        <link rel="up" title="Flopy Code" href="code.html"/>
        <link rel="prev" title="flopy.utils.swroutputfile Module" href="swroutputfile.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> flopy
          

          
          </a>

          
            
            
              <div class="version">
                3.2.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">What is FloPy?</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#flopy-installation">FloPy Installation?</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#flopy-resources">FloPy Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#flopy-development-team">FloPy Development Team</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Ipython Notebooks</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="code.html">Flopy Code</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="code.html#base-classes">Base Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#model-classes">Model Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#modflow-packages">MODFLOW Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#modflow-6-packages">MODFLOW 6 Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#modpath-packages">MODPATH Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#mt3dms-packages">MT3DMS Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#seawat-packages">SEAWAT Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#modflow-usg-packages">MODFLOW-USG Packages</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="code.html#model-utilities-including-binary-file-readers">Model Utilities (including binary file readers)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="check.html">flopy.utils.check Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="cvfdutil.html">flopy.utils.cvfdutil Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="datafile.html">flopy.utils.datafile Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="binaryfile.html">flopy.utils.binaryfile Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="binaryhydmodfile.html">flopy.utils.binaryhydmodfile Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="binaryswrfile.html">flopy.utils.binaryswrfile Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="flopy_io.html">flopy.utils.flopy_io Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="formattedfile.html">flopy.utils.formattedfile Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry.html">flopy.utils.geometry Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="gridgen.html">flopy.utils.gridgen Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="lgrutil.html">flopy.utils.lgrutil Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mflistfile.html">flopy.utils.mflistfile Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mfreadnam.html">flopy.utils.mfreadnam Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mfgrdfile.html">flopy.utils.mfgrdfile Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modpathfile.html">flopy.utils.modpathfile Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="observationfile.html">flopy.utils.observationfile Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="postprocessing.html">flopy.utils.postprocessing Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="shapefile_utils.html">flopy.export.shapefile_utils Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="swroutputfile.html">flopy.utils.swroutputfile Module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">flopy.utils.reference Module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfroutputfile.html">flopy.utils.sfroutputfile Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="util_array.html">flopy.utils.util_array Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils_def.html">flopy.utils.utils_def Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="util_list.html">flopy.utils.util_list Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="zonbud.html">flopy.utils.zonbud Module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="code.html#plotting-utilities">Plotting Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#export-utilities">Export Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="code.html#pest-utilities">PEST Utilities</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">flopy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="code.html">Flopy Code</a> &raquo;</li>
        
      <li>flopy.utils.reference Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/reference.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-flopy.utils.reference">
<span id="flopy-utils-reference-module"></span><h1>flopy.utils.reference Module<a class="headerlink" href="#module-flopy.utils.reference" title="Permalink to this headline">¶</a></h1>
<p>Module spatial referencing for flopy model objects</p>
<dl class="class">
<dt id="flopy.utils.reference.SpatialReference">
<em class="property">class </em><code class="descclassname">flopy.utils.reference.</code><code class="descname">SpatialReference</code><span class="sig-paren">(</span><em>delr=array([]</em>, <em>dtype=float64)</em>, <em>delc=array([]</em>, <em>dtype=float64)</em>, <em>lenuni=2</em>, <em>xul=None</em>, <em>yul=None</em>, <em>xll=None</em>, <em>yll=None</em>, <em>rotation=0.0</em>, <em>proj4_str=None</em>, <em>epsg=None</em>, <em>prj=None</em>, <em>units=None</em>, <em>length_multiplier=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference" title="Permalink to this definition">¶</a></dt>
<dd><p>a class to locate a structured model grid in x-y space</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>delr</strong> : numpy ndarray</p>
<blockquote>
<div><p>the model discretization delr vector
(An array of spacings along a row)</p>
</div></blockquote>
<p><strong>delc</strong> : numpy ndarray</p>
<blockquote>
<div><p>the model discretization delc vector
(An array of spacings along a column)</p>
</div></blockquote>
<p><strong>lenuni</strong> : int</p>
<blockquote>
<div><p>the length units flag from the discretization package
(default 2)</p>
</div></blockquote>
<p><strong>xul</strong> : float</p>
<blockquote>
<div><p>the x coordinate of the upper left corner of the grid
Enter either xul and yul or xll and yll.</p>
</div></blockquote>
<p><strong>yul</strong> : float</p>
<blockquote>
<div><p>the y coordinate of the upper left corner of the grid
Enter either xul and yul or xll and yll.</p>
</div></blockquote>
<p><strong>xll</strong> : float</p>
<blockquote>
<div><p>the x coordinate of the lower left corner of the grid
Enter either xul and yul or xll and yll.</p>
</div></blockquote>
<p><strong>yll</strong> : float</p>
<blockquote>
<div><p>the y coordinate of the lower left corner of the grid
Enter either xul and yul or xll and yll.</p>
</div></blockquote>
<p><strong>rotation</strong> : float</p>
<blockquote>
<div><p>the counter-clockwise rotation (in degrees) of the grid</p>
</div></blockquote>
<p><strong>proj4_str: str</strong></p>
<blockquote>
<div><p>a PROJ4 string that identifies the grid in space. warning: case
sensitive!</p>
</div></blockquote>
<p><strong>units</strong> : string</p>
<blockquote>
<div><p>Units for the grid.  Must be either feet or meters</p>
</div></blockquote>
<p><strong>epsg</strong> : int</p>
<blockquote>
<div><p>EPSG code that identifies the grid in space. Can be used in lieu of
proj4. PROJ4 attribute will auto-populate if there is an internet
connection(via get_proj4 method).
See <a class="reference external" href="https://www.epsg-registry.org/">https://www.epsg-registry.org/</a> or spatialreference.org</p>
</div></blockquote>
<p><strong>length_multiplier</strong> : float</p>
<blockquote class="last">
<div><p>multiplier to convert model units to spatial reference units.
delr and delc above will be multiplied by this value. (default=1.)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>xul and yul can be explicitly (re)set after SpatialReference
instantiation, but only before any of the other attributes and methods are
accessed</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#flopy.utils.reference.SpatialReference.vertices" title="flopy.utils.reference.SpatialReference.vertices"><code class="xref py py-obj docutils literal"><span class="pre">vertices</span></code></a></td>
<td>Returns a list of vertices for</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>xedge</td>
<td>(ndarray) array of column edges</td>
</tr>
<tr class="row-even"><td>yedge</td>
<td>(ndarray) array of row edges</td>
</tr>
<tr class="row-odd"><td>xgrid</td>
<td>(ndarray) numpy meshgrid of xedges</td>
</tr>
<tr class="row-even"><td>ygrid</td>
<td>(ndarray) numpy meshgrid of yedges</td>
</tr>
<tr class="row-odd"><td>xcenter</td>
<td>(ndarray) array of column centers</td>
</tr>
<tr class="row-even"><td>ycenter</td>
<td>(ndarray) array of row centers</td>
</tr>
<tr class="row-odd"><td>xcentergrid</td>
<td>(ndarray) numpy meshgrid of column centers</td>
</tr>
<tr class="row-even"><td>ycentergrid</td>
<td>(ndarray) numpy meshgrid of row centers</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="flopy.utils.reference.SpatialReference.bounds">
<code class="descname">bounds</code><a class="headerlink" href="#flopy.utils.reference.SpatialReference.bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Return bounding box in shapely order.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.contour_array">
<code class="descname">contour_array</code><span class="sig-paren">(</span><em>ax</em>, <em>a</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.contour_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a QuadMesh plot of the specified array using pcolormesh</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ax</strong> : matplotlib.axes.Axes</p>
<blockquote>
<div><p>ax to add the contours</p>
</div></blockquote>
<p><strong>a</strong> : np.ndarray</p>
<blockquote>
<div><p>array to contour</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>contour_set</strong> : ContourSet</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.export_array">
<code class="descname">export_array</code><span class="sig-paren">(</span><em>filename</em>, <em>a</em>, <em>nodata=-9999</em>, <em>fieldname='value'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.export_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a numpy array to Arc Ascii grid 
or shapefile with the model reference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Path of output file. Export format is determined by
file extention.
‘.asc’  Arc Ascii grid
‘.tif’  GeoTIFF (requries rasterio package)
‘.shp’  Shapefile</p>
</div></blockquote>
<p><strong>a</strong> : 2D numpy.ndarray</p>
<blockquote>
<div><p>Array to export</p>
</div></blockquote>
<p><strong>nodata</strong> : scalar</p>
<blockquote>
<div><p>Value to assign to np.nan entries (default -9999)</p>
</div></blockquote>
<p><strong>fieldname</strong> : str</p>
<blockquote>
<div><p>Attribute field name for array values (shapefile export only).
(default ‘values’)</p>
</div></blockquote>
<p><strong>kwargs:</strong></p>
<blockquote class="last">
<div><p>keyword arguments to np.savetxt (ascii) 
rasterio.open (GeoTIFF)
or flopy.export.shapefile_utils.write_grid_shapefile2</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Rotated grids will be either be unrotated prior to export,
using scipy.ndimage.rotate (Arc Ascii format) or rotation will be
included in their transform property (GeoTiff format). In either case
the pixels will be displayed in the (unrotated) projected geographic coordinate system,
so the pixels will no longer align exactly with the model grid
(as displayed from a shapefile, for example). A key difference between
Arc Ascii and GeoTiff (besides disk usage) is that the
unrotated Arc Ascii will have a different grid size, whereas the GeoTiff
will have the same number of rows and pixels as the original.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.export_array_contours">
<code class="descname">export_array_contours</code><span class="sig-paren">(</span><em>filename</em>, <em>a</em>, <em>fieldname='level'</em>, <em>interval=None</em>, <em>levels=None</em>, <em>maxlevels=1000</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.export_array_contours" title="Permalink to this definition">¶</a></dt>
<dd><p>Contour an array using matplotlib; write shapefile of contours.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Path of output file with ‘.shp’ extention.</p>
</div></blockquote>
<p><strong>a</strong> : 2D numpy array</p>
<blockquote>
<div><p>Array to contour</p>
</div></blockquote>
<p class="last"><strong>**kwargs</strong> : key-word arguments to flopy.export.shapefile_utils.recarray2shp</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.export_contours">
<code class="descname">export_contours</code><span class="sig-paren">(</span><em>filename</em>, <em>contours</em>, <em>fieldname='level'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.export_contours" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert matplotlib contour plot object to shapefile.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>path of output shapefile</p>
</div></blockquote>
<p><strong>contours</strong> : matplotlib.contour.QuadContourSet or list of them</p>
<blockquote>
<div><p>(object returned by matplotlib.pyplot.contour)</p>
</div></blockquote>
<p><strong>**kwargs</strong> : key-word arguments to flopy.export.shapefile_utils.recarray2shp</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>df</strong> : dataframe of shapefile contents</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.get_2d_vertex_connectivity">
<code class="descname">get_2d_vertex_connectivity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.get_2d_vertex_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the cell 2d vertices array and the iverts index array.  These
are the same form as the ones used to instantiate an unstructured
spatial reference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>verts</strong> : ndarray</p>
<blockquote>
<div><p>array of x and y coordinates for the grid vertices</p>
</div></blockquote>
<p><strong>iverts</strong> : list</p>
<blockquote class="last">
<div><p>a list with a list of vertex indices for each cell in clockwise
order starting with the upper left corner</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.get_extent">
<code class="descname">get_extent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.get_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the extent of the rotated and offset grid</p>
<p>Return (xmin, xmax, ymin, ymax)</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.get_grid_line_collection">
<code class="descname">get_grid_line_collection</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.get_grid_line_collection" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a LineCollection of the grid</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.get_grid_lines">
<code class="descname">get_grid_lines</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.get_grid_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the grid lines as a list</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.get_grid_map_plotter">
<code class="descname">get_grid_map_plotter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.get_grid_map_plotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a QuadMesh plotting object for this grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>quadmesh</strong> : matplotlib.collections.QuadMesh</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.get_rc">
<code class="descname">get_rc</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.get_rc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the row and column of a point or sequence of points
in real-world coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : scalar or sequence of x coordinates</p>
<p><strong>y</strong> : scalar or sequence of y coordinates</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>r</strong> : row or sequence of rows (zero-based)</p>
<p class="last"><strong>c</strong> : column or sequence of columns (zero-based)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.get_vertices">
<code class="descname">get_vertices</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.get_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>Get vertices for a single cell or sequence if i, j locations.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.get_xcenter_array">
<code class="descname">get_xcenter_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.get_xcenter_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell center x
coordinate for every column in the grid in model space - not offset or rotated.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.get_xedge_array">
<code class="descname">get_xedge_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.get_xedge_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell edge x
coordinates for every column in the grid in model space - not offset
or rotated.  Array is of size (ncol + 1)</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.get_ycenter_array">
<code class="descname">get_ycenter_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.get_ycenter_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell center x
coordinate for every row in the grid in model space - not offset of rotated.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.get_yedge_array">
<code class="descname">get_yedge_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.get_yedge_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell edge y
coordinates for every row in the grid in model space - not offset or
rotated. Array is of size (nrow + 1)</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.interpolate">
<code class="descname">interpolate</code><span class="sig-paren">(</span><em>a</em>, <em>xi</em>, <em>method='nearest'</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the griddata method to interpolate values from an array onto the
points defined in xi.  For any values outside of the grid, use
‘nearest’ to find a value for them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> : numpy.ndarray</p>
<blockquote>
<div><p>array to interpolate from.  It must be of size nrow, ncol</p>
</div></blockquote>
<p><strong>xi</strong> : numpy.ndarray</p>
<blockquote>
<div><p>array containing x and y point coordinates of size (npts, 2). xi
also works with broadcasting so that if a is a 2d array, then
xi can be passed in as (xgrid, ygrid).</p>
</div></blockquote>
<p><strong>method</strong> : {‘linear’, ‘nearest’, ‘cubic’}</p>
<blockquote>
<div><p>method to use for interpolation (default is ‘nearest’)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>b</strong> : numpy.ndarray</p>
<blockquote class="last">
<div><p>array of size (npts)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flopy.utils.reference.SpatialReference.length_multiplier">
<code class="descname">length_multiplier</code><a class="headerlink" href="#flopy.utils.reference.SpatialReference.length_multiplier" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to identify multiplier for converting from
model units to sr units, defaulting to 1.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flopy.utils.reference.SpatialReference.load">
<em class="property">static </em><code class="descname">load</code><span class="sig-paren">(</span><em>namefile=None</em>, <em>reffile='usgs.model.reference'</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to load spatial reference information from
the following files (in order):
1) usgs.model.reference
2) NAM file (header comment)
3) SpatialReference.default dictionary</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.plot_array">
<code class="descname">plot_array</code><span class="sig-paren">(</span><em>a</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.plot_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a QuadMesh plot of the specified array using pcolormesh</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a</strong> : np.ndarray</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>quadmesh</strong> : matplotlib.collections.QuadMesh</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="flopy.utils.reference.SpatialReference.read_usgs_model_reference_file">
<em class="property">static </em><code class="descname">read_usgs_model_reference_file</code><span class="sig-paren">(</span><em>reffile='usgs.model.reference'</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.read_usgs_model_reference_file" title="Permalink to this definition">¶</a></dt>
<dd><p>read spatial reference info from the usgs.model.reference file
<a class="reference external" href="https://water.usgs.gov/ogw/policy/gw-model/modelers-setup.html">https://water.usgs.gov/ogw/policy/gw-model/modelers-setup.html</a></p>
</dd></dl>

<dl class="staticmethod">
<dt id="flopy.utils.reference.SpatialReference.rotate">
<em class="property">static </em><code class="descname">rotate</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>theta</em>, <em>xorigin=0.0</em>, <em>yorigin=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Given x and y array-like values calculate the rotation about an
arbitrary origin and then return the rotated coordinates.  theta is in
degrees.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.set_spatialreference">
<code class="descname">set_spatialreference</code><span class="sig-paren">(</span><em>xul=None</em>, <em>yul=None</em>, <em>xll=None</em>, <em>yll=None</em>, <em>rotation=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.set_spatialreference" title="Permalink to this definition">¶</a></dt>
<dd><p>set spatial reference - can be called from model instance</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>inverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Given x and y array-like values, apply rotation, scale and offset,
to convert them from model coordinates to real-world coordinates.</p>
</dd></dl>

<dl class="attribute">
<dt id="flopy.utils.reference.SpatialReference.vertices">
<code class="descname">vertices</code><a class="headerlink" href="#flopy.utils.reference.SpatialReference.vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of vertices for</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.write_gridSpec">
<code class="descname">write_gridSpec</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.write_gridSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>write a PEST-style grid specification file</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReference.write_shapefile">
<code class="descname">write_shapefile</code><span class="sig-paren">(</span><em>filename='grid.shp'</em>, <em>epsg=None</em>, <em>prj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReference.write_shapefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a shapefile of the grid with just the row and column attributes</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured">
<em class="property">class </em><code class="descclassname">flopy.utils.reference.</code><code class="descname">SpatialReferenceUnstructured</code><span class="sig-paren">(</span><em>xc</em>, <em>yc</em>, <em>verts</em>, <em>iverts</em>, <em>ncpl</em>, <em>layered=True</em>, <em>lenuni=1</em>, <em>proj4_str='EPSG:4326'</em>, <em>epsg=None</em>, <em>units=None</em>, <em>length_multiplier=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured" title="Permalink to this definition">¶</a></dt>
<dd><p>a class to locate an unstructured model grid in x-y space</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>verts</strong> : ndarray</p>
<blockquote>
<div><p>2d array of x and y points.</p>
</div></blockquote>
<p><strong>iverts</strong> : list of lists</p>
<blockquote>
<div><p>should be of len(ncells) with a list of vertex numbers for each cell</p>
</div></blockquote>
<p><strong>ncpl</strong> : ndarray</p>
<blockquote>
<div><p>array containing the number of cells per layer.  ncpl.sum() must be
equal to the total number of cells in the grid.</p>
</div></blockquote>
<p><strong>layered</strong> : boolean</p>
<blockquote>
<div><p>flag to indicated that the grid is layered.  In this case, the vertices
define the grid for single layer, and all layers use this same grid.
In this case the ncpl value for each layer must equal len(iverts).
If not layered, then verts and iverts are specified for all cells and
all layers in the grid.  In this case, npcl.sum() must equal
len(iverts).</p>
</div></blockquote>
<p><strong>lenuni</strong> : int</p>
<blockquote>
<div><p>the length units flag from the discretization package</p>
</div></blockquote>
<p><strong>proj4_str: str</strong></p>
<blockquote>
<div><p>a PROJ4 string that identifies the grid in space. warning: case
sensitive!</p>
</div></blockquote>
<p><strong>units</strong> : string</p>
<blockquote>
<div><p>Units for the grid.  Must be either feet or meters</p>
</div></blockquote>
<p><strong>epsg</strong> : int</p>
<blockquote>
<div><p>EPSG code that identifies the grid in space. Can be used in lieu of
proj4. PROJ4 attribute will auto-populate if there is an internet
connection(via get_proj4 method).
See <a class="reference external" href="https://www.epsg-registry.org/">https://www.epsg-registry.org/</a> or spatialreference.org</p>
</div></blockquote>
<p><strong>length_multiplier</strong> : float</p>
<blockquote class="last">
<div><p>multiplier to convert model units to spatial reference units.
delr and delc above will be multiplied by this value. (default=1.)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>xcenter</td>
<td>(ndarray) array of x cell centers</td>
</tr>
<tr class="row-even"><td>ycenter</td>
<td>(ndarray) array of y cell centers</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.bounds">
<code class="descname">bounds</code><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Return bounding box in shapely order.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.contour_array">
<code class="descname">contour_array</code><span class="sig-paren">(</span><em>ax</em>, <em>a</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.contour_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a QuadMesh plot of the specified array using pcolormesh</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ax</strong> : matplotlib.axes.Axes</p>
<blockquote>
<div><p>ax to add the contours</p>
</div></blockquote>
<p><strong>a</strong> : np.ndarray</p>
<blockquote>
<div><p>array to contour</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>contour_set</strong> : ContourSet</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.export_array">
<code class="descname">export_array</code><span class="sig-paren">(</span><em>filename</em>, <em>a</em>, <em>nodata=-9999</em>, <em>fieldname='value'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.export_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a numpy array to Arc Ascii grid 
or shapefile with the model reference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Path of output file. Export format is determined by
file extention.
‘.asc’  Arc Ascii grid
‘.tif’  GeoTIFF (requries rasterio package)
‘.shp’  Shapefile</p>
</div></blockquote>
<p><strong>a</strong> : 2D numpy.ndarray</p>
<blockquote>
<div><p>Array to export</p>
</div></blockquote>
<p><strong>nodata</strong> : scalar</p>
<blockquote>
<div><p>Value to assign to np.nan entries (default -9999)</p>
</div></blockquote>
<p><strong>fieldname</strong> : str</p>
<blockquote>
<div><p>Attribute field name for array values (shapefile export only).
(default ‘values’)</p>
</div></blockquote>
<p><strong>kwargs:</strong></p>
<blockquote class="last">
<div><p>keyword arguments to np.savetxt (ascii) 
rasterio.open (GeoTIFF)
or flopy.export.shapefile_utils.write_grid_shapefile2</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Rotated grids will be either be unrotated prior to export,
using scipy.ndimage.rotate (Arc Ascii format) or rotation will be
included in their transform property (GeoTiff format). In either case
the pixels will be displayed in the (unrotated) projected geographic coordinate system,
so the pixels will no longer align exactly with the model grid
(as displayed from a shapefile, for example). A key difference between
Arc Ascii and GeoTiff (besides disk usage) is that the
unrotated Arc Ascii will have a different grid size, whereas the GeoTiff
will have the same number of rows and pixels as the original.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.export_array_contours">
<code class="descname">export_array_contours</code><span class="sig-paren">(</span><em>filename</em>, <em>a</em>, <em>fieldname='level'</em>, <em>interval=None</em>, <em>levels=None</em>, <em>maxlevels=1000</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.export_array_contours" title="Permalink to this definition">¶</a></dt>
<dd><p>Contour an array using matplotlib; write shapefile of contours.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Path of output file with ‘.shp’ extention.</p>
</div></blockquote>
<p><strong>a</strong> : 2D numpy array</p>
<blockquote>
<div><p>Array to contour</p>
</div></blockquote>
<p class="last"><strong>**kwargs</strong> : key-word arguments to flopy.export.shapefile_utils.recarray2shp</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.export_contours">
<code class="descname">export_contours</code><span class="sig-paren">(</span><em>filename</em>, <em>contours</em>, <em>fieldname='level'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.export_contours" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert matplotlib contour plot object to shapefile.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>path of output shapefile</p>
</div></blockquote>
<p><strong>contours</strong> : matplotlib.contour.QuadContourSet or list of them</p>
<blockquote>
<div><p>(object returned by matplotlib.pyplot.contour)</p>
</div></blockquote>
<p><strong>**kwargs</strong> : key-word arguments to flopy.export.shapefile_utils.recarray2shp</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>df</strong> : dataframe of shapefile contents</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.from_argus_export">
<em class="property">classmethod </em><code class="descname">from_argus_export</code><span class="sig-paren">(</span><em>fname</em>, <em>nlay=1</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.from_argus_export" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new SpatialReferenceUnstructured grid from an Argus One
Trimesh file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : string</p>
<blockquote>
<div><p>File name</p>
</div></blockquote>
<p><strong>nlay</strong> : int</p>
<blockquote>
<div><p>Number of layers to create</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>sru</strong> : flopy.utils.reference.SpatialReferenceUnstructured</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.from_gridspec">
<em class="property">classmethod </em><code class="descname">from_gridspec</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.from_gridspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new SpatialReferenceUnstructured grid from an PEST
grid specification file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : string</p>
<blockquote>
<div><p>File name for grid specification file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>sru</strong> : flopy.utils.reference.SpatialReferenceUnstructured</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.get_2d_vertex_connectivity">
<code class="descname">get_2d_vertex_connectivity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.get_2d_vertex_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the cell 2d vertices array and the iverts index array.  These
are the same form as the ones used to instantiate an unstructured
spatial reference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>verts</strong> : ndarray</p>
<blockquote>
<div><p>array of x and y coordinates for the grid vertices</p>
</div></blockquote>
<p><strong>iverts</strong> : list</p>
<blockquote class="last">
<div><p>a list with a list of vertex indices for each cell in clockwise
order starting with the upper left corner</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.get_extent">
<code class="descname">get_extent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.get_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the extent of the grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>extent</strong> : tuple</p>
<blockquote class="last">
<div><p>min and max grid coordinates</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.get_grid_line_collection">
<code class="descname">get_grid_line_collection</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.get_grid_line_collection" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a patch collection of the grid</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.get_grid_lines">
<code class="descname">get_grid_lines</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.get_grid_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the grid lines as a list</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.get_grid_map_plotter">
<code class="descname">get_grid_map_plotter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.get_grid_map_plotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a QuadMesh plotting object for this grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>quadmesh</strong> : matplotlib.collections.QuadMesh</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.get_rc">
<code class="descname">get_rc</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.get_rc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the row and column of a point or sequence of points
in real-world coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : scalar or sequence of x coordinates</p>
<p><strong>y</strong> : scalar or sequence of y coordinates</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>r</strong> : row or sequence of rows (zero-based)</p>
<p class="last"><strong>c</strong> : column or sequence of columns (zero-based)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.get_vertices">
<code class="descname">get_vertices</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.get_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>Get vertices for a single cell or sequence if i, j locations.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.get_xcenter_array">
<code class="descname">get_xcenter_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.get_xcenter_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell center x
coordinate for every cell in the grid in model space - not offset or
rotated.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.get_xedge_array">
<code class="descname">get_xedge_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.get_xedge_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell edge x
coordinates for every column in the grid in model space - not offset
or rotated.  Array is of size (ncol + 1)</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.get_ycenter_array">
<code class="descname">get_ycenter_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.get_ycenter_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell center x
coordinate for every cell in the grid in model space - not offset of
rotated.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.get_yedge_array">
<code class="descname">get_yedge_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.get_yedge_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy one-dimensional float array that has the cell edge y
coordinates for every row in the grid in model space - not offset or
rotated. Array is of size (nrow + 1)</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.interpolate">
<code class="descname">interpolate</code><span class="sig-paren">(</span><em>a</em>, <em>xi</em>, <em>method='nearest'</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the griddata method to interpolate values from an array onto the
points defined in xi.  For any values outside of the grid, use
‘nearest’ to find a value for them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> : numpy.ndarray</p>
<blockquote>
<div><p>array to interpolate from.  It must be of size nrow, ncol</p>
</div></blockquote>
<p><strong>xi</strong> : numpy.ndarray</p>
<blockquote>
<div><p>array containing x and y point coordinates of size (npts, 2). xi
also works with broadcasting so that if a is a 2d array, then
xi can be passed in as (xgrid, ygrid).</p>
</div></blockquote>
<p><strong>method</strong> : {‘linear’, ‘nearest’, ‘cubic’}</p>
<blockquote>
<div><p>method to use for interpolation (default is ‘nearest’)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>b</strong> : numpy.ndarray</p>
<blockquote class="last">
<div><p>array of size (npts)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.length_multiplier">
<code class="descname">length_multiplier</code><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.length_multiplier" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to identify multiplier for converting from
model units to sr units, defaulting to 1.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>namefile=None</em>, <em>reffile='usgs.model.reference'</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to load spatial reference information from
the following files (in order):
1) usgs.model.reference
2) NAM file (header comment)
3) SpatialReference.default dictionary</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.plot_array">
<code class="descname">plot_array</code><span class="sig-paren">(</span><em>a</em>, <em>ax=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.plot_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a QuadMesh plot of the specified array using patches</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a</strong> : np.ndarray</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>quadmesh</strong> : matplotlib.collections.QuadMesh</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.read_usgs_model_reference_file">
<code class="descname">read_usgs_model_reference_file</code><span class="sig-paren">(</span><em>reffile='usgs.model.reference'</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.read_usgs_model_reference_file" title="Permalink to this definition">¶</a></dt>
<dd><p>read spatial reference info from the usgs.model.reference file
<a class="reference external" href="https://water.usgs.gov/ogw/policy/gw-model/modelers-setup.html">https://water.usgs.gov/ogw/policy/gw-model/modelers-setup.html</a></p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>theta</em>, <em>xorigin=0.0</em>, <em>yorigin=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Given x and y array-like values calculate the rotation about an
arbitrary origin and then return the rotated coordinates.  theta is in
degrees.</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.set_spatialreference">
<code class="descname">set_spatialreference</code><span class="sig-paren">(</span><em>xul=None</em>, <em>yul=None</em>, <em>xll=None</em>, <em>yll=None</em>, <em>rotation=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.set_spatialreference" title="Permalink to this definition">¶</a></dt>
<dd><p>set spatial reference - can be called from model instance</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>inverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Given x and y array-like values, apply rotation, scale and offset,
to convert them from model coordinates to real-world coordinates.</p>
</dd></dl>

<dl class="attribute">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.vertices">
<code class="descname">vertices</code><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of vertices for</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.write_gridSpec">
<code class="descname">write_gridSpec</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.write_gridSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PEST-style grid specification file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>filename for grid specification file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.SpatialReferenceUnstructured.write_shapefile">
<code class="descname">write_shapefile</code><span class="sig-paren">(</span><em>filename='grid.shp'</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.SpatialReferenceUnstructured.write_shapefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Write shapefile of the grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>filename for shapefile</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flopy.utils.reference.TemporalReference">
<em class="property">class </em><code class="descclassname">flopy.utils.reference.</code><code class="descname">TemporalReference</code><span class="sig-paren">(</span><em>itmuni=4</em>, <em>start_datetime=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.TemporalReference" title="Permalink to this definition">¶</a></dt>
<dd><p>For now, just a container to hold start time and time units files
outside of DIS package.</p>
</dd></dl>

<dl class="class">
<dt id="flopy.utils.reference.crs">
<em class="property">class </em><code class="descclassname">flopy.utils.reference.</code><code class="descname">crs</code><span class="sig-paren">(</span><em>prj=None</em>, <em>esri_wkt=None</em>, <em>epsg=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.crs" title="Permalink to this definition">¶</a></dt>
<dd><p>Container to parse and store coordinate reference system parameters,
and translate between different formats.</p>
<dl class="attribute">
<dt id="flopy.utils.reference.crs.crs">
<code class="descname">crs</code><a class="headerlink" href="#flopy.utils.reference.crs.crs" title="Permalink to this definition">¶</a></dt>
<dd><p>Dict mapping crs attibutes to proj4 parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="flopy.utils.reference.crs.grid_mapping_attribs">
<code class="descname">grid_mapping_attribs</code><a class="headerlink" href="#flopy.utils.reference.crs.grid_mapping_attribs" title="Permalink to this definition">¶</a></dt>
<dd><p>Map parameters for CF Grid Mappings
<a class="reference external" href="http://cfconventions.org/cf-conventions/v1.6.0">http://cfconventions.org/cf-conventions/v1.6.0</a>
/cf-conventions.html#appendix-grid-mappings</p>
</dd></dl>

<dl class="attribute">
<dt id="flopy.utils.reference.crs.proj4">
<code class="descname">proj4</code><a class="headerlink" href="#flopy.utils.reference.crs.proj4" title="Permalink to this definition">¶</a></dt>
<dd><p>Not implemented yet</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flopy.utils.reference.epsgRef">
<em class="property">class </em><code class="descclassname">flopy.utils.reference.</code><code class="descname">epsgRef</code><a class="headerlink" href="#flopy.utils.reference.epsgRef" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up a local database of projection file text referenced by epsg code.
The database is located in the site packages folder in epsgref.py, which
contains a dictionary, prj, of projection file text keyed by epsg value.</p>
<dl class="method">
<dt id="flopy.utils.reference.epsgRef.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>epsg</em>, <em>prj</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.epsgRef.add" title="Permalink to this definition">¶</a></dt>
<dd><p>add an epsg code to epsgref.py</p>
</dd></dl>

<dl class="method">
<dt id="flopy.utils.reference.epsgRef.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><em>epsg</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.epsgRef.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>removes an epsg entry from epsgref.py</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="flopy.utils.reference.get_spatialreference">
<code class="descclassname">flopy.utils.reference.</code><code class="descname">get_spatialreference</code><span class="sig-paren">(</span><em>epsg</em>, <em>text='esriwkt'</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.get_spatialreference" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets text for given epsg code and text format from spatialreference.org
Fetches the reference text using the url:</p>
<blockquote>
<div><a class="reference external" href="http://spatialreference.org/ref/epsg">http://spatialreference.org/ref/epsg</a>/&lt;epsg code&gt;/&lt;text&gt;/</div></blockquote>
<p>See: <a class="reference external" href="https://www.epsg-registry.org/">https://www.epsg-registry.org/</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>epsg</strong> : int</p>
<blockquote>
<div><p>epsg code for coordinate system</p>
</div></blockquote>
<p><strong>text</strong> : str</p>
<blockquote>
<div><p>string added to url</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>url</strong> : str</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flopy.utils.reference.getprj">
<code class="descclassname">flopy.utils.reference.</code><code class="descname">getprj</code><span class="sig-paren">(</span><em>epsg</em>, <em>addlocalreference=True</em>, <em>text='esriwkt'</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.getprj" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets projection file (.prj) text for given epsg code from spatialreference.org
See: <a class="reference external" href="https://www.epsg-registry.org/">https://www.epsg-registry.org/</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>epsg</strong> : int</p>
<blockquote>
<div><p>epsg code for coordinate system</p>
</div></blockquote>
<p><strong>addlocalreference</strong> : boolean</p>
<blockquote>
<div><p>adds the projection file text associated with epsg to a local
database, epsgref.py, located in site-packages.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>prj</strong> : str</p>
<blockquote class="last">
<div><p>text for a projection (<a href="#id1"><span class="problematic" id="id2">*</span></a>.prj) file.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flopy.utils.reference.getproj4">
<code class="descclassname">flopy.utils.reference.</code><code class="descname">getproj4</code><span class="sig-paren">(</span><em>epsg</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.utils.reference.getproj4" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets projection file (.prj) text for given epsg code from
spatialreference.org. See: <a class="reference external" href="https://www.epsg-registry.org/">https://www.epsg-registry.org/</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>epsg</strong> : int</p>
<blockquote>
<div><p>epsg code for coordinate system</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>prj</strong> : str</p>
<blockquote class="last">
<div><p>text for a projection (<a href="#id3"><span class="problematic" id="id4">*</span></a>.prj) file.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="swroutputfile.html" class="btn btn-neutral" title="flopy.utils.swroutputfile Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      Last updated on Jan 08, 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.2.8',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
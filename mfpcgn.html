<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>flopy.modflow.mfpcgn Module &mdash; flopy 3.2.6 documentation</title>
    
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.2.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="flopy 3.2.6 documentation" href="index.html" />
    <link rel="up" title="Flopy Code" href="code.html" />
    <link rel="next" title="flopy.modflow.mfrch Module" href="mfrch.html" />
    <link rel="prev" title="flopy.modflow.mfpcg Module" href="mfpcg.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">
<div class="header" role="banner">
  <div class="logo">
    <a href="index.html">
      <img class="logo" src="_static/flopylogo.png" alt="Logo"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mfrch.html" title="flopy.modflow.mfrch Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mfpcg.html" title="flopy.modflow.mfpcg Module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">flopy 3.2.6 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="code.html" accesskey="U">Flopy Code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-flopy.modflow.mfpcgn">
<span id="flopy-modflow-mfpcgn-module"></span><h1>flopy.modflow.mfpcgn Module<a class="headerlink" href="#module-flopy.modflow.mfpcgn" title="Permalink to this headline">¶</a></h1>
<p>mfpcgn module.  Contains the ModflowPcgn class. Note that the user can access
the ModflowStr class as <cite>flopy.modflow.ModflowPcgn</cite>.</p>
<p>Additional information for this MODFLOW package can be found at the <a class="reference external" href="http://water.usgs.gov/ogw/modflow/MODFLOW-2005-Guide/pcgn.htm">Online
MODFLOW Guide</a>.</p>
<dl class="class">
<dt id="flopy.modflow.mfpcgn.ModflowPcgn">
<em class="property">class </em><code class="descclassname">flopy.modflow.mfpcgn.</code><code class="descname">ModflowPcgn</code><span class="sig-paren">(</span><em>model</em>, <em>iter_mo=50</em>, <em>iter_mi=30</em>, <em>close_r=1e-05</em>, <em>close_h=1e-05</em>, <em>relax=1.0</em>, <em>ifill=0</em>, <em>unit_pc=None</em>, <em>unit_ts=None</em>, <em>adamp=0</em>, <em>damp=1.0</em>, <em>damp_lb=0.001</em>, <em>rate_d=0.1</em>, <em>chglimit=0.0</em>, <em>acnvg=0</em>, <em>cnvg_lb=0.001</em>, <em>mcnvg=2</em>, <em>rate_c=-1.0</em>, <em>ipunit=None</em>, <em>extension='pcgn'</em>, <em>unitnumber=None</em>, <em>filenames=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.modflow.mfpcgn.ModflowPcgn" title="Permalink to this definition">¶</a></dt>
<dd><p>MODFLOW Pcgn Package Class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>model</strong> : model object</p>
<blockquote>
<div><p>The model object (of type <a class="reference internal" href="mf.html#flopy.modflow.mf.Modflow" title="flopy.modflow.mf.Modflow"><code class="xref py py-class docutils literal"><span class="pre">flopy.modflow.mf.Modflow</span></code></a>) to which
this package will be added.</p>
</div></blockquote>
<p><strong>iter_mo</strong> : int</p>
<blockquote>
<div><p>The maximum number of picard (outer) iterations allowed. For nonlinear
problems, this variable must be set to some number greater than one,
depending on the problem size and degree of nonlinearity. If iter_mo
is set to 1, then the pcgn solver assumes that the problem is linear
and the input requirements are greatly truncated. (default is 50)</p>
</div></blockquote>
<p><strong>iter_mi</strong> : int</p>
<blockquote>
<div><p>maximum number of pcg (inner) iterations allowed. Generally,
this variable is set to some number greater than one, depending on
the matrix size, degree of convergence called for, and the nature of
the problem. For a nonlinear problem, iter_mi should be set large
enough that the pcg iteration converges freely with the relative
convergence parameter epsilon described in the Parameters Related
to Convergence of Inner Iteration: Line 4 subsection.
(default is 30)</p>
</div></blockquote>
<p><strong>close_r</strong> : float</p>
<blockquote>
<div><p>The residual-based stopping criterion for iteration. This parameter is
used differently, depending on whether it is applied to a linear or
nonlinear problem.</p>
<p>If iter_mo = 1: For a linear problem, the variant of the conjugate
gradient method outlined in algorithm 2 is employed, but uses the
absolute convergence criterion in place of the relative convergence
criterion. close_r is used as the value in the absolute convergence
criterion for quitting the pcg iterative solver. close_r is compared
to the square root of the weighted residual norm. In particular, if
the square root of the weighted residual norm is less than close_r,
then the linear Pcg iterative solve is said to have converged,
causing the pcg iteration to cease and control of the program to
pass out of the pcg solver.</p>
<p>If iter_mo &gt; 1: For a nonlinear problem, close_r is used as a criterion
for quitting the picard (outer) iteration. close_r is compared to the
square root of the inner product of the residuals (the residual norm)
as calculated on entry to the pcg solver at the beginning of every
picard iteration. if this norm is less than close_r, then the picard
iteration is considered to have converged.</p>
</div></blockquote>
<p><strong>close_h</strong> : float</p>
<blockquote>
<div><p>close_h is used as an alternate stopping criterion for the picard
iteration needed to solve a nonlinear problem. The maximum value of
the head change is obtained for each picard iteration, after completion
of the inner, pcg iteration. If this maximum head change is less than
close_h, then the picard iteration is considered tentatively to have
converged. However, as nonlinear problems can demonstrate oscillation
in the head solution, the picard iteration is not declared to have
converged unless the maximum head change is less than close_h for
three picard iterations. If these picard iterations are sequential,
then a good solution is assumed to have been obtained. If the picard
iterations are not sequential, then a warning is issued advising that
the convergence is conditional and the user is urged to examine the
mass balance of the solution.</p>
</div></blockquote>
<p><strong>relax</strong> : float</p>
<blockquote>
<div><p>is the relaxation parameter used with npcond = 1. (default is 1.0)</p>
</div></blockquote>
<p><strong>ifill</strong> : int</p>
<blockquote>
<div><p>is the fill level of the mic preconditioner. Preconditioners with
fill levels of 0 and 1 are available (ifill = 0 and ifill = 1,
respectively). (default is 0)</p>
</div></blockquote>
<p><strong>unit_pc</strong> : int</p>
<blockquote>
<div><p>is the unit number of an optional output file where progress for the
inner PCG iteration can be written. (default is 0)</p>
</div></blockquote>
<p><strong>unit_ts</strong> : int</p>
<blockquote>
<div><p>is the unit number of an optional output file where the actual time in
the PCG solver is accumulated. (default is 0)</p>
</div></blockquote>
<p><strong>adamp</strong> : int</p>
<blockquote>
<div><p>defines the mode of damping applied to the linear solution. In general,
damping determines how much of the head changes vector shall be applied
to the hydraulic head vector hj in picard iteration j. If adamp = 0,
Ordinary damping is employed and a constant value of damping parameter
will be used throughout the picard iteration; this option requires a
valid value for damp. If adamp = 1, Adaptive damping is employed. If
adamp = 2: Enhanced damping algorithm in which the damping value is
increased (but never decreased) provided the picard iteration is
proceeding satisfactorily. (default is 0)</p>
</div></blockquote>
<p><strong>damp</strong> : float</p>
<blockquote>
<div><p>is the damping factor. (default is 1.)</p>
</div></blockquote>
<p><strong>damp_lb</strong> : float</p>
<blockquote>
<div><p>is the lower bound placed on the dampening; generally, 0 &lt; damp_lb &lt; damp.
(default is 0.001)</p>
</div></blockquote>
<p><strong>rate_d</strong> : float</p>
<blockquote>
<div><p>is a rate parameter; generally, 0 &lt; rate_d &lt; 1. (default is 0.1)</p>
</div></blockquote>
<p><strong>chglimit</strong> : float</p>
<blockquote>
<div><p>this variable limits the maximum head change applicable to the updated
hydraulic heads in a Picard iteration. If chglimit = 0.0, then adaptive
damping proceeds without this feature. (default is 0.)</p>
</div></blockquote>
<p><strong>acnvg</strong> : int</p>
<blockquote>
<div><p>defines the mode of convergence applied to the PCG solver. (default is 0)</p>
</div></blockquote>
<p><strong>cnvg_lb</strong> : int</p>
<blockquote>
<div><p>is the minimum value that the relative convergence is allowed to take under
the self-adjusting convergence option. cnvg_lb is used only in convergence
mode acnvg = 1. (default is 0.001)</p>
</div></blockquote>
<p><strong>mcnvg</strong> : float</p>
<blockquote>
<div><p>increases the relative PCG convergence criteria by a power equal to MCNVG.
MCNVG is used only in convergence mode acnvg = 2. (default is 2)</p>
</div></blockquote>
<p><strong>rate_c</strong> : float</p>
<blockquote>
<div><p>this option results in variable enhancement of epsilon. If 0 &lt; rate_c &lt; 1,
then enhanced relative convergence is allowed to decrease by increasing
epsilon(j) = epsilon(j-1) + rate_c epsilon(j-1), where j is the Picard
iteration number; this change in epsilon occurs so long as the Picard
iteration is progressing satisfactorily. If rate_c &lt;= 0, then the value
of epsilon set by mcnvg remains unchanged through the picard iteration.
It should be emphasized that rate_c must have a value greater than 0
for the variable enhancement to be effected; otherwise epsilon remains
constant. rate_c is used only in convergence mode acnvg = 2.
(default is -1.)</p>
</div></blockquote>
<p><strong>ipunit</strong> : int</p>
<blockquote>
<div><p>enables progress reporting for the picard iteration. If ipunit &gt;= 0,
then a record of progress made by the picard iteration for each time
step is printed in the MODFLOW Listing file (Harbaugh and others, 2000).
This record consists of the total number of dry cells at the end of each
time step as well as the total number of PCG iterations necessary to
obtain convergence. In addition, if ipunit &gt; 0, then extensive
diagnostics for each Picard iteration is also written in comma-separated
format to a file whose unit number corresponds to ipunit; the name for
this file, along with its unit number and type &#8216;data&#8217; should be entered
in the modflow Name file. If ipunit &lt; 0 then printing of all progress
concerning the Picard iteration is suppressed, as well as information on
the nature of the convergence of the picard iteration. (default is 0)</p>
</div></blockquote>
<p><strong>extension</strong> : list string</p>
<blockquote>
<div><p>Filename extension (default is &#8216;pcgn&#8217;)</p>
</div></blockquote>
<p><strong>unitnumber</strong> : int</p>
<blockquote>
<div><p>File unit number (default is None).</p>
</div></blockquote>
<p><strong>filenames</strong> : str or list of str</p>
<blockquote class="last">
<div><p>Filenames to use for the package and the output files. If
filenames=None the package name will be created using the model name
and package extension and the pcgn output names will be created using
the model name and .pcgni, .pcgnt, and .pcgno extensions. If a single
string is passed the package will be set to the string and pcgn output
names will be created using the model name and pcgn output extensions.
To define the names for all package files (input and output) the length
of the list of strings should be 4. Default is None.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">flopy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">Modflow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcgn</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">ModflowPcgn</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<dl class="staticmethod">
<dt id="flopy.modflow.mfpcgn.ModflowPcgn.load">
<em class="property">static </em><code class="descname">load</code><span class="sig-paren">(</span><em>f</em>, <em>model</em>, <em>ext_unit_dict=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.modflow.mfpcgn.ModflowPcgn.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an existing package.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>f</strong> : filename or file handle</p>
<blockquote>
<div><p>File to load.</p>
</div></blockquote>
<p><strong>model</strong> : model object</p>
<blockquote>
<div><p>The model object (of type <a class="reference internal" href="mf.html#flopy.modflow.mf.Modflow" title="flopy.modflow.mf.Modflow"><code class="xref py py-class docutils literal"><span class="pre">flopy.modflow.mf.Modflow</span></code></a>) to
which this package will be added.</p>
</div></blockquote>
<p><strong>ext_unit_dict</strong> : dictionary, optional</p>
<blockquote>
<div><p>If the arrays in the file are specified using EXTERNAL,
or older style array control records, then <cite>f</cite> should be a file
handle.  In this case ext_unit_dict is required, which can be
constructed using the function
<a class="reference internal" href="mfreadnam.html#flopy.utils.mfreadnam.parsenamefile" title="flopy.utils.mfreadnam.parsenamefile"><code class="xref py py-class docutils literal"><span class="pre">flopy.utils.mfreadnam.parsenamefile</span></code></a>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>pcgn</strong> : ModflowPcgn object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">flopy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">Modflow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pcgn</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">ModflowPcgn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;test.pcgn&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="flopy.modflow.mfpcgn.ModflowPcgn.write_file">
<code class="descname">write_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.modflow.mfpcgn.ModflowPcgn.write_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the package file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="mfpcg.html"
                        title="previous chapter">flopy.modflow.mfpcg Module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mfrch.html"
                        title="next chapter">flopy.modflow.mfrch Module</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mfrch.html" title="flopy.modflow.mfrch Module"
             >next</a> |</li>
        <li class="right" >
          <a href="mfpcg.html" title="flopy.modflow.mfpcg Module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">flopy 3.2.6 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="code.html" >Flopy Code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Last updated on Mar 20, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>
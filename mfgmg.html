<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>flopy.modflow.mfgmg Module &mdash; flopy 3.2.6 documentation</title>
    
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.2.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="flopy 3.2.6 documentation" href="index.html" />
    <link rel="up" title="Flopy Code" href="code.html" />
    <link rel="next" title="flopy.modflow.mflak Module" href="mflak.html" />
    <link rel="prev" title="flopy.modflow.mfghb Module" href="mfghb.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">
<div class="header" role="banner">
  <div class="logo">
    <a href="index.html">
      <img class="logo" src="_static/flopylogo.png" alt="Logo"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mflak.html" title="flopy.modflow.mflak Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mfghb.html" title="flopy.modflow.mfghb Module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">flopy 3.2.6 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="code.html" accesskey="U">Flopy Code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-flopy.modflow.mfgmg">
<span id="flopy-modflow-mfgmg-module"></span><h1>flopy.modflow.mfgmg Module<a class="headerlink" href="#module-flopy.modflow.mfgmg" title="Permalink to this headline">¶</a></h1>
<p>mfgmg module.  Contains the ModflowGmg class. Note that the user can access
the ModflowGmg class as <cite>flopy.modflow.ModflowGmg</cite>.</p>
<p>Additional information for this MODFLOW package can be found at the <a class="reference external" href="http://water.usgs.gov/ogw/modflow/MODFLOW-2005-Guide/gmg.htm">Online
MODFLOW Guide</a>.</p>
<dl class="class">
<dt id="flopy.modflow.mfgmg.ModflowGmg">
<em class="property">class </em><code class="descclassname">flopy.modflow.mfgmg.</code><code class="descname">ModflowGmg</code><span class="sig-paren">(</span><em>model</em>, <em>mxiter=50</em>, <em>iiter=30</em>, <em>iadamp=0</em>, <em>hclose=1e-05</em>, <em>rclose=1e-05</em>, <em>relax=1.0</em>, <em>ioutgmg=0</em>, <em>iunitmhc=None</em>, <em>ism=0</em>, <em>isc=0</em>, <em>damp=1.0</em>, <em>dup=0.75</em>, <em>dlow=0.01</em>, <em>chglimit=1.0</em>, <em>extension='gmg'</em>, <em>unitnumber=None</em>, <em>filenames=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.modflow.mfgmg.ModflowGmg" title="Permalink to this definition">¶</a></dt>
<dd><p>MODFLOW GMG Package Class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>model</strong> : model object</p>
<blockquote>
<div><p>The model object (of type <a class="reference internal" href="mf.html#flopy.modflow.mf.Modflow" title="flopy.modflow.mf.Modflow"><code class="xref py py-class docutils literal"><span class="pre">flopy.modflow.mf.Modflow</span></code></a>) to which
this package will be added.</p>
</div></blockquote>
<p><strong>mxiter</strong> : int</p>
<blockquote>
<div><p>maximum number of outer iterations. (default is 50)</p>
</div></blockquote>
<p><strong>iiter</strong> : int</p>
<blockquote>
<div><p>maximum number of inner iterations. (default is 30)</p>
</div></blockquote>
<p><strong>iadamp</strong> : int</p>
<blockquote>
<div><p>is a flag that controls adaptive damping. The possible values
of iadamp are.</p>
<p>If iadamp = 0, then the value assigned to DAMP is used as a constant
damping parameter.</p>
<p>If iadamp = 1, the value of damp is used for the first nonlinear
iteration. The damping parameter is adaptively varied on the basis
of the head change, using Cooley&#8217;s method as described in Mehl
and Hill (2001), for subsequent iterations.</p>
<p>If iadamp = 2, the relative reduced residual damping method documented
in Mehl and Hill (2001) and modified by Banta (2006) is used.</p>
<p>When iadamp is specified as 2 and the value specified for DAMP is less
than 0.5, the closure criterion for the inner iterations (drclose) is
assigned simply as rclose. When damp is between 0.5 and 1.0, inclusive,
or when iadamp is specified as 0 or 1, drclose is calculated according
to equation 20 on p. 9 of Wilson and Naff (2004).</p>
</div></blockquote>
<p><strong>hclose</strong> : float</p>
<blockquote>
<div><p>is the head change criterion for convergence. (default is 1e-5).</p>
</div></blockquote>
<p><strong>rclose</strong> : float</p>
<blockquote>
<div><p>is the residual criterion for convergence. (default is 1e-5)</p>
</div></blockquote>
<p><strong>relax</strong> : float</p>
<blockquote>
<div><p>is a relaxation parameter for the ILU preconditioned conjugate
gradient method. The relax parameter can be used to improve the
spectral condition number of the ILU preconditioned system. The value
of relax should be approximately one. However, the relaxation parameter
can cause the factorization to break down. If this happens, then the
gmg solver will report an assembly error and a value smaller than one
for relax should be tried. This item is read only if isc = 4.</p>
</div></blockquote>
<p><strong>ioutgmg</strong> : int</p>
<blockquote>
<div><p>is a flag that controls the output of the gmg solver. The
possible values of ioutgmg are.</p>
<p>If ioutgmg = 0, then only the solver inputs are printed.</p>
<p>If ioutgmg = 1, then for each linear solve, the number of pcg
iterations, the value of the damping parameter, the l2norm of
the residual, and the maxnorm of the head change and its location
(column, row, layer) are printed. At the end of a time/stress period,
the total number of gmg calls, pcg iterations, and a running total
of pcg iterations for all time/stress periods are printed.</p>
<p>If ioutgmg = 2, then the convergence history of the pcg iteration is
printed, showing the l2norm of the residual and the convergence factor
for each iteration.</p>
<p>ioutgmg = 3 is the same as ioutgmg = 1 except output is sent to the
terminal instead of the modflow list output file.</p>
<p>ioutgmg = 4 is the same as ioutgmg = 2 except output is sent to the
terminal instead of the modflow list output file.</p>
<p>(default is 0)</p>
</div></blockquote>
<p><strong>iunitmhc</strong> : int</p>
<blockquote>
<div><p>is a flag and a unit number, which controls output of maximum
head change values. If iunitmhc = 0, maximum head change values
are not written to an output file. If iunitmhc &gt; 0, maximum head
change values are written to unit iunitmhc. Unit iunitmhc should
be listed in the Name file with &#8216;DATA&#8217; as the file type. If
iunitmhc &lt; 0 or is not present, iunitmhc defaults to 0.
(default is 0)</p>
</div></blockquote>
<p><strong>ism</strong> : int</p>
<blockquote>
<div><p>is a flag that controls the type of smoother used in the multigrid
preconditioner. If ism = 0, then ilu(0) smoothing is implemented in
the multigrid preconditioner; this smoothing requires an additional
ector on each multigrid level to store the pivots in the ilu
factorization. If ism = 1, then symmetric gaussseidel (sgs) smoothing
is implemented in the multigrid preconditioner. No additional storage
is required if ism = 1; users may want to use this option if available
memory is exceeded or nearly exceeded when using ism = 0. Using sgs
smoothing is not as robust as ilu smoothing; additional iterations are
likely to be required in reducing the residuals. In extreme cases, the
solver may fail to converge as the residuals cannot be reduced
sufficiently. (default is 0)</p>
</div></blockquote>
<p><strong>isc</strong> : int</p>
<blockquote>
<div><p>is a flag that controls semicoarsening in the multigrid
preconditioner. If isc = 0, then the rows, columns and layers are
all coarsened. If isc = 1, then the rows and columns are coarsened,
but the layers are not. If isc = 2, then the columns and layers are
coarsened, but the rows are not. If isc = 3, then the rows and layers
are coarsened, but the columns are not. If isc = 4, then there is no
coarsening. Typically, the value of isc should be 0 or 1. In the case
that there are large vertical variations in the hydraulic conductivities,
then a value of 1 should be used. If no coarsening is implemented
(isc = 4), then the gmg solver is comparable to the pcg2 ilu(0) solver
described in Hill (1990) and uses the least amount of memory.
(default is 0)</p>
</div></blockquote>
<p><strong>damp</strong> : float</p>
<blockquote>
<div><p>is the value of the damping parameter. For linear problems, a value
of 1.0 should be used. For nonlinear problems, a value less than 1.0 but
greater than 0.0 may be necessary to achieve convergence. A typical
value for nonlinear problems is 0.5. Damping also helps control the
convergence criterion of the linear solve to alleviate excessive pcg
iterations. (default 1.)</p>
</div></blockquote>
<p><strong>dup</strong> : float</p>
<blockquote>
<div><p>is the maximum damping value that should be applied at any iteration
when the solver is not oscillating; it is dimensionless. An appropriate
value for dup will be problem-dependent. For moderately nonlinear problems,
reasonable values for dup would be in the range 0.5 to 1.0. For a highly
nonlinear problem, a reasonable value for dup could be as small as 0.1.
When the solver is oscillating, a damping value as large as 2.0 x DUP may
be applied. (default is 0.75)</p>
</div></blockquote>
<p><strong>dlow</strong> : float</p>
<blockquote>
<div><p>is the minimum damping value to be generated by the adaptive-damping
procedure; it is dimensionless. An appropriate value for dlow will be
problem-dependent and will be smaller than the value specified for dup.
For a highly nonlinear problem, an appropriate value for dlow might be as
small as 0.001. Note that the value specified for the variable, chglimit,
could result in application of a damping value smaller than dlow.
(default is 0.01)</p>
</div></blockquote>
<p><strong>chglimit</strong> : float</p>
<blockquote>
<div><p>is the maximum allowed head change at any cell between outer iterations;
it has units of length. The effect of chglimit is to determine a damping
value that, when applied to all elements of the head-change vector, will
produce an absolute maximum head change equal to chglimit.
(default is 1.0)</p>
</div></blockquote>
<p><strong>extension</strong> : list string</p>
<blockquote>
<div><p>Filename extension (default is &#8216;gmg&#8217;)</p>
</div></blockquote>
<p><strong>unitnumber</strong> : int</p>
<blockquote>
<div><p>File unit number (default is None).</p>
</div></blockquote>
<p><strong>filenames</strong> : str or list of str</p>
<blockquote>
<div><p>Filenames to use for the package and the output files. If
filenames=None the package name will be created using the model name
and package extension and the gmg output name will be created using
the model name and .cbc extension (for example, modflowtest.gmg.out),
if iunitmhc is a number greater than zero. If a single string is passed
the package will be set to the string and gmg output names will be
created using the model name and .gmg.out extension, if iunitmhc is a
number greater than zero. To define the names for all package files
(input and output) the length of the list of strings should be 2.
Default is None.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">flopy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">Modflow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmg</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">ModflowGmg</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<dl class="staticmethod">
<dt id="flopy.modflow.mfgmg.ModflowGmg.load">
<em class="property">static </em><code class="descname">load</code><span class="sig-paren">(</span><em>f</em>, <em>model</em>, <em>ext_unit_dict=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.modflow.mfgmg.ModflowGmg.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an existing package.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>f</strong> : filename or file handle</p>
<blockquote>
<div><p>File to load.</p>
</div></blockquote>
<p><strong>model</strong> : model object</p>
<blockquote>
<div><p>The model object (of type <a class="reference internal" href="mf.html#flopy.modflow.mf.Modflow" title="flopy.modflow.mf.Modflow"><code class="xref py py-class docutils literal"><span class="pre">flopy.modflow.mf.Modflow</span></code></a>) to
which this package will be added.</p>
</div></blockquote>
<p><strong>ext_unit_dict</strong> : dictionary, optional</p>
<blockquote>
<div><p>If the arrays in the file are specified using EXTERNAL,
or older style array control records, then <cite>f</cite> should be a file
handle.  In this case ext_unit_dict is required, which can be
constructed using the function
<a class="reference internal" href="mfreadnam.html#flopy.utils.mfreadnam.parsenamefile" title="flopy.utils.mfreadnam.parsenamefile"><code class="xref py py-class docutils literal"><span class="pre">flopy.utils.mfreadnam.parsenamefile</span></code></a>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>gmg</strong> : ModflowGmg object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">flopy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">Modflow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gmg</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">ModflowGmg</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;test.gmg&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="flopy.modflow.mfgmg.ModflowGmg.write_file">
<code class="descname">write_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.modflow.mfgmg.ModflowGmg.write_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the package file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="mfghb.html"
                        title="previous chapter">flopy.modflow.mfghb Module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mflak.html"
                        title="next chapter">flopy.modflow.mflak Module</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mflak.html" title="flopy.modflow.mflak Module"
             >next</a> |</li>
        <li class="right" >
          <a href="mfghb.html" title="flopy.modflow.mfghb Module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">flopy 3.2.6 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="code.html" >Flopy Code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Last updated on Mar 20, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>flopy.modflow.mfsms Module &mdash; flopy 3.2.6 documentation</title>
    
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.2.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="flopy 3.2.6 documentation" href="index.html" />
    <link rel="up" title="Flopy Code" href="code.html" />
    <link rel="next" title="flopy.modflow.mfsor Module" href="mfsor.html" />
    <link rel="prev" title="flopy.modflow.mfsip Module" href="mfsip.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">
<div class="header" role="banner">
  <div class="logo">
    <a href="index.html">
      <img class="logo" src="_static/flopylogo.png" alt="Logo"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mfsor.html" title="flopy.modflow.mfsor Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mfsip.html" title="flopy.modflow.mfsip Module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">flopy 3.2.6 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="code.html" accesskey="U">Flopy Code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-flopy.modflow.mfsms">
<span id="flopy-modflow-mfsms-module"></span><h1>flopy.modflow.mfsms Module<a class="headerlink" href="#module-flopy.modflow.mfsms" title="Permalink to this headline">¶</a></h1>
<p>mfsms module.  This is the solver for MODFLOW-USG.
Contains the ModflowSms class. Note that the user can access
the ModflowSms class as <cite>flopy.modflow.ModflowSms</cite>.</p>
<dl class="class">
<dt id="flopy.modflow.mfsms.ModflowSms">
<em class="property">class </em><code class="descclassname">flopy.modflow.mfsms.</code><code class="descname">ModflowSms</code><span class="sig-paren">(</span><em>model</em>, <em>hclose=0.0001</em>, <em>hiclose=0.0001</em>, <em>mxiter=100</em>, <em>iter1=20</em>, <em>iprsms=2</em>, <em>nonlinmeth=0</em>, <em>linmeth=2</em>, <em>theta=0.7</em>, <em>akappa=0.1</em>, <em>gamma=0.2</em>, <em>amomentum=0.001</em>, <em>numtrack=20</em>, <em>btol=10000.0</em>, <em>breduc=0.2</em>, <em>reslim=100.0</em>, <em>iacl=2</em>, <em>norder=0</em>, <em>level=7</em>, <em>north=2</em>, <em>iredsys=0</em>, <em>rrctol=0.0</em>, <em>idroptol=0</em>, <em>epsrn=0.001</em>, <em>clin='bcgs'</em>, <em>ipc=3</em>, <em>iscl=0</em>, <em>iord=0</em>, <em>rclosepcgu=0.1</em>, <em>relaxpcgu=1.0</em>, <em>extension='sms'</em>, <em>options=None</em>, <em>unitnumber=None</em>, <em>filenames=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.modflow.mfsms.ModflowSms" title="Permalink to this definition">¶</a></dt>
<dd><p>MODFLOW Basic Package Class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>model</strong> : model object</p>
<blockquote>
<div><p>The model object (of type <a class="reference internal" href="mf.html#flopy.modflow.mf.Modflow" title="flopy.modflow.mf.Modflow"><code class="xref py py-class docutils literal"><span class="pre">flopy.modflow.mf.Modflow</span></code></a>) to which
this package will be added.</p>
</div></blockquote>
<p><strong>hclose</strong> : float</p>
<blockquote>
<div><p>is the head change criterion for convergence of the outer (nonlinear)
iterations, in units of length. When the maximum absolute value of the
head change at all nodes during an iteration is less than or equal to
HCLOSE, iteration stops. Commonly, HCLOSE equals 0.01.</p>
</div></blockquote>
<p><strong>hiclose</strong> : float</p>
<blockquote>
<div><p>is the head change criterion for convergence of the inner (linear)
iterations, in units of length. When the maximum absolute value of the
head change at all nodes during an iteration is less than or equal to
HICLOSE, the matrix solver assumes convergence. Commonly, HICLOSE is
set an order of magnitude less than HCLOSE.</p>
</div></blockquote>
<p><strong>mxiter</strong> : int</p>
<blockquote>
<div><p>is the maximum number of outer (nonlinear) iterations &#8211; that is,
calls to the solution routine. For a linear problem MXITER should be 1.</p>
</div></blockquote>
<p><strong>iter1</strong> : int</p>
<blockquote>
<div><p>is the maximum number of inner (linear) iterations. The number
typically depends on the characteristics of the matrix solution
scheme being used. For nonlinear problems, ITER1 usually ranges
from 60 to 600; a value of 100 will be sufficient for most linear
problems.</p>
</div></blockquote>
<p><strong>iprsms</strong> : int</p>
<blockquote>
<div><p>is a flag that controls printing of convergence information from the
solver: 0 is print nothing; 1 is print only the total number of
iterations and nonlinear residual reduction summaries;  2 is print
matrix solver information in addition to above.</p>
</div></blockquote>
<p><strong>nonlinmeth</strong> : int</p>
<blockquote>
<div><p>is a flag that controls the nonlinear solution method and under-
relaxation schemes. 0 is Picard iteration scheme is used without any
under-relaxation schemes involved. &gt; 0 is Newton-Raphson iteration
scheme is used with under-relaxation. Note that the Newton-Raphson
linearization scheme is available only for the upstream weighted
solution scheme of the BCF and LPF packages. &lt; 0 is Picard iteration
scheme is used with under-relaxation. The absolute value of NONLINMETH
determines the underrelaxation scheme used. 1 or -1, then
Delta-Bar-Delta under-relaxation is used. 2 or -2 then Cooley
under-relaxation scheme is used.
Note that the under-relaxation schemes are used in conjunction with
gradient based methods, however, experience has indicated that the
Cooley under-relaxation and damping work well also for the Picard
scheme with the wet/dry options of MODFLOW.</p>
</div></blockquote>
<p><strong>linmeth</strong> : int</p>
<blockquote>
<div><p>is a flag that controls the matrix solution method. 1 is the XMD
solver of Ibaraki (2005). 2 is the unstructured pre-conditioned
conjugate gradient solver of White and Hughes (2011).</p>
</div></blockquote>
<p><strong>theta</strong> : float</p>
<blockquote>
<div><p>is the reduction factor for the learning rate (under-relaxation term)
of the delta-bar-delta algorithm. The value of THETA is between zero
and one. If the change in the variable (head) is of opposite sign to
that of the previous iteration, the under-relaxation term is reduced
by a factor of THETA. The value usually ranges from 0.3 to 0.9; a
value of 0.7 works well for most problems.</p>
</div></blockquote>
<p><strong>akappa</strong> : float</p>
<blockquote>
<div><p>is the increment for the learning rate (under-relaxation term) of the
delta-bar-delta algorithm. The value of AKAPPA is between zero and
one. If the change in the variable (head) is of the same sign to that
of the previous iteration, the under-relaxation term is increased by
an increment of AKAPPA. The value usually ranges from 0.03 to 0.3; a
value of 0.1 works well for most problems.</p>
</div></blockquote>
<p><strong>gamma</strong> : float</p>
<blockquote>
<div><p>is the history or memory term factor of the delta-bar-delta algorithm.
Gamma is between zero and 1 but cannot be equal to one. When GAMMA is
zero, only the most recent history (previous iteration value) is
maintained. As GAMMA is increased, past history of iteration changes
has greater influence on the memory term.  The memory term is
maintained as an exponential average of past changes. Retaining some
past history can overcome granular behavior in the calculated function
surface and therefore helps to overcome cyclic patterns of
non-convergence. The value usually ranges from 0.1 to 0.3; a value of
0.2 works well for most problems.</p>
</div></blockquote>
<p><strong>amomentum</strong> : float</p>
<blockquote>
<div><p>is the fraction of past history changes that is added as a momentum
term to the step change for a nonlinear iteration. The value of
AMOMENTUM is between zero and one. A large momentum term should only
be used when small learning rates are expected. Small amounts of the
momentum term help convergence. The value usually ranges from 0.0001
to 0.1; a value of 0.001 works well for most problems.</p>
</div></blockquote>
<p><strong>numtrack</strong> : int</p>
<blockquote>
<div><p>is the maximum number of backtracking iterations allowed for residual
reduction computations. If NUMTRACK = 0 then the backtracking
iterations are omitted. The value usually ranges from 2 to 20; a
value of 10 works well for most problems.</p>
</div></blockquote>
<p><strong>numtrack</strong> : int</p>
<blockquote>
<div><p>is the maximum number of backtracking iterations allowed for residual
reduction computations. If NUMTRACK = 0 then the backtracking
iterations are omitted. The value usually ranges from 2 to 20; a
value of 10 works well for most problems.</p>
</div></blockquote>
<p><strong>btol</strong> : float</p>
<blockquote>
<div><p>is the tolerance for residual change that is allowed for residual
reduction computations. BTOL should not be less than one to avoid
getting stuck in local minima. A large value serves to check for
extreme residual increases, while a low value serves to control
step size more severely. The value usually ranges from 1.0 to 1e6 ; a
value of 1e4 works well for most problems but lower values like 1.1
may be required for harder problems.</p>
</div></blockquote>
<p><strong>breduce</strong> : float</p>
<blockquote>
<div><p>is the reduction in step size used for residual reduction
computations. The value of BREDUC is between zero and one. The value
usually ranges from 0.1 to 0.3; a value of 0.2 works well for most
problems.</p>
</div></blockquote>
<p><strong>reslim</strong> : float</p>
<blockquote>
<div><p>is the limit to which the residual is reduced with backtracking.
If the residual is smaller than RESLIM, then further backtracking is
not performed. A value of 100 is suitable for large problems and
residual reduction to smaller values may only slow down computations.</p>
</div></blockquote>
<p><strong>iacl</strong> : int</p>
<blockquote>
<div><p>is the flag for choosing the acceleration method. 0 is Conjugate
Gradient; select this option if the matrix is symmetric. 1 is
ORTHOMIN. 2 is BiCGSTAB.</p>
</div></blockquote>
<p><strong>norder</strong> : int</p>
<blockquote>
<div><p>is the flag for choosing the ordering scheme.
0 is original ordering
1 is reverse Cuthill McKee ordering
2 is Minimum degree ordering</p>
</div></blockquote>
<p><strong>level</strong> : int</p>
<blockquote>
<div><p>is the level of fill for ILU decomposition. Higher levels of fill
provide more robustness but also require more memory. For optimal
performance, it is suggested that a large level of fill be applied
(7 or 8) with use of drop tolerance.</p>
</div></blockquote>
<p><strong>north</strong> : int</p>
<blockquote>
<div><p>is the number of orthogonalizations for the ORTHOMIN acceleration
scheme. A number between 4 and 10 is appropriate. Small values require
less storage but more iteration may be required. This number should
equal 2 for the other acceleration methods.</p>
</div></blockquote>
<p><strong>iredsys</strong> : int</p>
<blockquote>
<div><p>is the index for creating a reduced system of equations using the
red-black ordering scheme.
0 is do not create reduced system
1 is create reduced system using red-black ordering</p>
</div></blockquote>
<p><strong>rrctol</strong> : float</p>
<blockquote>
<div><p>is a residual tolerance criterion for convergence. The root mean
squared residual of the matrix solution is evaluated against this
number to determine convergence. The solver assumes convergence if
either HICLOSE (the absolute head tolerance value for the solver) or
RRCTOL is achieved. Note that a value of zero ignores residual
tolerance in favor of the absolute tolerance (HICLOSE) for closure of
the matrix solver.</p>
</div></blockquote>
<p><strong>idroptol</strong> : int</p>
<blockquote>
<div><p>is the flag to perform drop tolerance.
0 is do not perform drop tolerance
1 is perform drop tolerance</p>
</div></blockquote>
<p><strong>epsrn</strong> : float</p>
<blockquote>
<div><p>is the drop tolerance value. A value of 1e-3 works well for most
problems.</p>
</div></blockquote>
<p><strong>clin</strong> : string</p>
<blockquote>
<div><p>an option keyword that defines the linear acceleration method used by
the PCGU solver.
CLIN is &#8220;CG&#8221;, then preconditioned conjugate gradient method.
CLIN is &#8220;BCGS&#8221;, then preconditioned bi-conjugate gradient stabilized
method.</p>
</div></blockquote>
<p><strong>ipc</strong> : int</p>
<blockquote>
<div><p>an integer value that defines the preconditioner.
IPC = 0, No preconditioning.
IPC = 1, Jacobi preconditioning.
IPC = 2, ILU(0) preconditioning.
IPC = 3, MILU(0) preconditioning (default).</p>
</div></blockquote>
<p><strong>iscl</strong> : int</p>
<blockquote>
<div><p>is the flag for choosing the matrix scaling approach used.
0 is no matrix scaling applied
1 is symmetric matrix scaling using the scaling method by the POLCG
preconditioner in Hill (1992).
2 is symmetric matrix scaling using the l2 norm of each row of
A (DR) and the l2 norm of each row of DRA.</p>
</div></blockquote>
<p><strong>iord</strong> : int</p>
<blockquote>
<div><p>is the flag for choosing the matrix reordering approach used.
0 = original ordering
1 = reverse Cuthill McKee ordering
2 = minimum degree ordering</p>
</div></blockquote>
<p><strong>rclosepcgu</strong> : float</p>
<blockquote>
<div><p>a real value that defines the flow residual tolerance for convergence
of the PCGU linear solver. This value represents the maximum allowable
residual at any single node. Value is in units of length cubed per
time, and must be consistent with MODFLOW-USG length and time units.
Usually a value of 1.0x10-1 is sufficient for the flow-residual
criteria when meters and seconds are the defined MODFLOW-USG length
and time.</p>
</div></blockquote>
<p><strong>relaxpcgu</strong> : float</p>
<blockquote>
<div><p>a real value that defines the relaxation factor used by the MILU(0)
preconditioner. RELAXPCGU is unitless and should be greater than or
equal to 0.0 and less than or equal to 1.0. RELAXPCGU values of about
1.0 are commonly used, and experience suggests that convergence can
be optimized in some cases with RELAXPCGU values of 0.97. A RELAXPCGU
value of 0.0 will result in ILU(0) preconditioning. RELAXPCGU is only
specified if IPC=3. If RELAXPCGU is not specified and IPC=3, then a
default value of 0.97 will be assigned to RELAXPCGU.</p>
</div></blockquote>
<p><strong>extension</strong> : str, optional</p>
<blockquote>
<div><p>File extension (default is &#8216;sms&#8217;.</p>
</div></blockquote>
<p><strong>unitnumber</strong> : int, optional</p>
<blockquote>
<div><p>FORTRAN unit number for this package (default is None).</p>
</div></blockquote>
<p><strong>filenames</strong> : str or list of str</p>
<blockquote class="last">
<div><p>Filenames to use for the package. If filenames=None the package name
will be created using the model name and package extension. If a
single string is passed the package will be set to the string.
Default is None.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">flopy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">Modflow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sms</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">ModflowSms</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<dl class="staticmethod">
<dt id="flopy.modflow.mfsms.ModflowSms.load">
<em class="property">static </em><code class="descname">load</code><span class="sig-paren">(</span><em>f</em>, <em>model</em>, <em>ext_unit_dict=None</em><span class="sig-paren">)</span><a class="headerlink" href="#flopy.modflow.mfsms.ModflowSms.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an existing package.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>f</strong> : filename or file handle</p>
<blockquote>
<div><p>File to load.</p>
</div></blockquote>
<p><strong>model</strong> : model object</p>
<blockquote>
<div><p>The model object (of type <a class="reference internal" href="mf.html#flopy.modflow.mf.Modflow" title="flopy.modflow.mf.Modflow"><code class="xref py py-class docutils literal"><span class="pre">flopy.modflow.mf.Modflow</span></code></a>) to
which this package will be added.</p>
</div></blockquote>
<p><strong>ext_unit_dict</strong> : dictionary, optional</p>
<blockquote>
<div><p>If the arrays in the file are specified using EXTERNAL,
or older style array control records, then <cite>f</cite> should be a file
handle.  In this case ext_unit_dict is required, which can be
constructed using the function
<a class="reference internal" href="mfreadnam.html#flopy.utils.mfreadnam.parsenamefile" title="flopy.utils.mfreadnam.parsenamefile"><code class="xref py py-class docutils literal"><span class="pre">flopy.utils.mfreadnam.parsenamefile</span></code></a>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>sms</strong> : ModflowSms object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">flopy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">Modflow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sms</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">modflow</span><span class="o">.</span><span class="n">ModflowPcg</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;test.sms&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="flopy.modflow.mfsms.ModflowSms.write_file">
<code class="descname">write_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#flopy.modflow.mfsms.ModflowSms.write_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the package file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="mfsip.html"
                        title="previous chapter">flopy.modflow.mfsip Module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mfsor.html"
                        title="next chapter">flopy.modflow.mfsor Module</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mfsor.html" title="flopy.modflow.mfsor Module"
             >next</a> |</li>
        <li class="right" >
          <a href="mfsip.html" title="flopy.modflow.mfsip Module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">flopy 3.2.6 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="code.html" >Flopy Code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Last updated on Mar 20, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>